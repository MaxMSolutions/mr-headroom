.text-editor {
  display: flex;
  flex-direction: column;
  height: 100%;
  font-family: var(--font-main), 'Courier New', monospace;
  color: var(--text-primary);
  background: linear-gradient(135deg, rgba(10, 5, 20, 0.95), rgba(30, 15, 45, 0.95));
  position: relative;
  overflow: hidden;
  /* Add cyberpunk grid pattern overlay */
  background-image:
    linear-gradient(90deg, rgba(0, 195, 255, 0.05) 1px, transparent 1px),
    linear-gradient(0deg, rgba(0, 195, 255, 0.05) 1px, transparent 1px);
  background-size: 8px 8px;
  border-radius: 2px;
}

/* Add subtle scanlines to the text editor */
.text-editor::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    to bottom,
    transparent,
    rgba(51, 255, 51, 0.03),
    transparent
  );
  background-size: 100% 4px;
  pointer-events: none;
  z-index: 1;
  animation: subtle-scan 8s linear infinite;
}

@keyframes subtle-scan {
  0% { background-position: 0 0; }
  100% { background-position: 0 100px; }
}

.text-editor-toolbar {
  display: flex;
  padding: 4px 8px;
  background: linear-gradient(90deg, rgba(10, 5, 20, 0.9), rgba(30, 12, 45, 0.9));
  border-bottom: 1px solid var(--accent-secondary);
  position: relative;
  overflow: hidden;
  text-shadow: 0 0 5px var(--text-primary);
  box-shadow: inset 0 0 6px rgba(0, 195, 255, 0.3);
  /* Add futuristic circuit pattern */
  background-image:
    radial-gradient(circle at 10% 20%, rgba(0, 195, 255, 0.1) 1px, transparent 1px),
    radial-gradient(circle at 90% 80%, rgba(0, 195, 255, 0.1) 1px, transparent 1px);
  /* Add subtle scan line effect */
  animation: titlebarScanline 10s linear infinite;
}

@keyframes titlebarScanline {
  0% { background-position: 0 0; }
}

.text-editor-toolbar-button {
  display: flex;
  align-items: center;
  padding: 2px 8px;
  margin-right: 4px;
  background-color: var(--bg-secondary);
  color: var(--text-primary);
  border: 1px solid var(--accent-secondary);
  border-radius: 2px;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  text-shadow: 0 0 3px var(--text-primary);
}

.text-editor-toolbar-button:hover {
  background-color: var(--accent-secondary);
  color: var(--bg-primary);
  text-shadow: 0 0 5px var(--bg-primary);
  box-shadow: 0 0 8px var(--accent-secondary);
}

.text-editor-content {
  flex: 1;
  padding: 0;
  display: flex;
  overflow: hidden;
  position: relative;
}

.text-editor-textarea {
  width: 100%;
  height: 100%;
  resize: none;
  border: none;
  outline: none;
  padding: 8px;
  background-color: var(--terminal-bg, #000000);
  color: var(--text-primary, #33ff33);
  font-family: var(--font-main), 'Courier New', monospace;
  font-size: 14px;
  line-height: 1.4;
  caret-color: var(--accent-primary);
  text-shadow: 0 0 3px var(--text-primary);
  letter-spacing: 1px;
  animation: cursor-pulse 1.5s infinite;
  position: relative;
  z-index: 2;
}

/* Add grid overlay to textarea background */
.text-editor-textarea::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image:
    linear-gradient(rgba(0, 255, 255, 0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px);
  background-size: 20px 20px;
  pointer-events: none;
  z-index: -1;
}

/* Custom blinking cursor effect */
@keyframes cursor-pulse {
  0%, 100% { caret-color: var(--accent-primary); }
  50% { caret-color: transparent; }
}

.text-editor-status-bar {
  padding: 4px 8px;
  background: linear-gradient(90deg, rgba(10, 5, 20, 0.9), rgba(30, 12, 45, 0.9));
  border-top: 1px solid var(--accent-secondary);
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: var(--text-secondary);
  font-family: var(--font-main);
  letter-spacing: 1px;
  text-shadow: 0 0 3px var(--text-secondary);
  position: relative;
  box-shadow: inset 0 0 6px rgba(0, 195, 255, 0.3);
}

/* Add a subtle horizontal scanning line */
.text-editor-status-bar::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 2px;
  background-color: var(--accent-secondary);
  box-shadow: 0 0 5px var(--accent-secondary);
  opacity: 0.5;
  animation: status-scan 3s linear infinite;
}

@keyframes status-scan {
  0% { left: -100%; }
  100% { left: 100%; }
}

.text-editor-status-bar span {
  margin-right: 16px;
}

/* Dark mode styling - already dark by default now */
.text-editor.dark .text-editor-toolbar {
  background-color: var(--window-header, #0a0a0a);
  color: var(--accent-primary, #ff00ff);
}

.text-editor.dark .text-editor-toolbar-button {
  background-color: var(--bg-secondary);
  color: var(--accent-primary);
  border-color: var(--accent-primary);
}

.text-editor.dark .text-editor-toolbar-button:hover {
  background-color: var(--accent-primary);
  color: var(--bg-secondary);
}

.text-editor.dark .text-editor-textarea {
  background-color: var(--terminal-bg, #000000);
  color: var(--accent-primary);
}

.text-editor.dark .text-editor-status-bar {
  background-color: var(--window-header, #0a0a0a);
  color: var(--accent-primary);
  border-top-color: var(--accent-primary);
}

.text-editor.dark .text-editor-status-bar::after {
  background-color: var(--accent-primary);
  box-shadow: 0 0 5px var(--accent-primary);
}

/* Cursor blinking animation */
@keyframes cursor-blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* Custom selection color */
.text-editor-textarea::selection {
  background-color: var(--accent-secondary, #00ffff);
  color: var(--bg-primary, #000000);
}

/* Glitch effects */
@keyframes text-glitch {
  0% { transform: translate(0); }
  20% { transform: translate(-2px, 2px); }
  40% { transform: translate(-2px, -2px); }
  60% { transform: translate(2px, 2px); }
  80% { transform: translate(2px, -2px); }
  100% { transform: translate(0); }
}

.text-editor.glitching .text-editor-textarea {
  animation: text-glitch 0.1s infinite;
  position: relative;
}

.text-editor.glitching .text-editor-textarea::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(255, 0, 255, 0.05);
  mix-blend-mode: overlay;
  pointer-events: none;
}

.text-editor.glitching::before {
  content: "SIGNAL INTERFERENCE";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: var(--accent-primary, #ff00ff);
  font-size: 32px;
  font-weight: bold;
  opacity: 0.2;
  z-index: 2;
  text-shadow: 0 0 10px var(--accent-primary);
  animation: flicker 0.2s infinite;
  pointer-events: none;
}

@keyframes flicker {
  0%, 100% { opacity: 0.2; }
  50% { opacity: 0.1; }
}

/* Line numbers effect */
.text-editor-textarea {
  counter-reset: line;
}

/* Advanced cursor effect */
.text-editor-textarea:focus {
  caret-shape: bar;
}

/* Accessibility mode */
body.accessibility-mode .text-editor.glitching .text-editor-textarea {
  animation: none;
}

body.accessibility-mode .text-editor.glitching .text-editor-textarea::after,
body.accessibility-mode .text-editor.glitching::before {
  display: none;
}

body.accessibility-mode .text-editor::before {
  display: none;
}

/* Save Dialog Styles */
.save-dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.75);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 99999; /* Very high z-index to ensure it's always on top */
}

/* Ensure this class takes precedence */
.always-on-top {
  position: fixed !important;
  z-index: 999999 !important;
  animation: none !important; /* Prevent any animations that might cause flickering */
}

.save-dialog {
  width: 400px;
  background-color: var(--bg-secondary);
  border: 2px solid var(--accent-primary);
  box-shadow: 0 0 20px var(--accent-primary);
  color: var(--text-primary);
  position: absolute;
}

/* Removed dialog animation to avoid flashing issues */

.save-dialog-title {
  background-color: var(--window-header);
  margin: 0;
  padding: 8px 12px;
  font-size: 16px;
  border-bottom: 1px solid var(--accent-secondary);
  color: var(--accent-primary);
  text-shadow: 0 0 5px var(--accent-primary);
  cursor: move; /* Indicate it's draggable */
  user-select: none; /* Prevent text selection when dragging */
}

.save-dialog-content {
  padding: 16px;
}

.save-dialog-field {
  margin-bottom: 12px;
  display: flex;
  flex-direction: column;
}

.save-dialog-field label {
  margin-bottom: 4px;
  color: var(--accent-secondary);
  font-size: 14px;
}

.save-dialog-input,
.save-dialog-select {
  background-color: var(--terminal-bg);
  border: 1px solid var(--accent-secondary);
  color: var(--text-primary);
  padding: 6px 8px;
  font-family: var(--font-main), monospace;
  caret-color: var(--accent-primary);
}

.save-dialog-input:focus,
.save-dialog-select:focus {
  outline: none;
  box-shadow: 0 0 5px var(--accent-secondary);
}

.save-dialog-actions {
  padding: 12px;
  display: flex;
  justify-content: flex-end;
  border-top: 1px solid var(--accent-secondary);
  background-color: var(--window-header);
}

.save-dialog-button {
  margin-left: 8px;
  padding: 6px 12px;
  background-color: var(--bg-secondary);
  color: var(--accent-secondary);
  border: 1px solid var(--accent-secondary);
  cursor: pointer;
  font-family: var(--font-main), monospace;
}

.save-dialog-button:hover {
  background-color: var(--accent-secondary);
  color: var(--bg-secondary);
  box-shadow: 0 0 8px var(--accent-secondary);
}

/* Add a cool scan effect to the dialog */
.save-dialog::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 2px;
  background-color: var(--accent-secondary);
  box-shadow: 0 0 10px var(--accent-secondary);
  opacity: 0.7;
  animation: dialog-scan 2s linear infinite;
}

@keyframes dialog-scan {
  0% { top: 0; }
  100% { top: 100%; }
}

/* File dialog (open/save) shared styles */
.file-dialog-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.6);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10000;
  opacity: 1;
  transition: opacity 0.2s ease-in-out;
}

.file-dialog {
  width: 500px;
  background-color: var(--bg-secondary, #0a0a0a);
  border: 2px solid var(--accent-primary, #33ff33);
  box-shadow: 0 0 10px var(--accent-secondary, #00ffff);
  display: flex;
  flex-direction: column;
  z-index: 1001;
}

.file-dialog-title {
  background-color: var(--window-header, #0a0a0a);
  color: var(--accent-secondary, #00ffff);
  padding: 8px 12px;
  font-weight: bold;
  cursor: move;
  border-bottom: 1px solid var(--accent-primary, #33ff33);
  text-transform: uppercase;
}

.file-dialog-content {
  padding: 16px;
  max-height: 400px;
  overflow-y: auto;
}

.file-dialog-field {
  margin-bottom: 12px;
  display: flex;
  flex-direction: column;
}

.file-dialog-field label {
  margin-bottom: 4px;
  color: var(--accent-primary, #33ff33);
}

.file-dialog-input,
.file-dialog-select {
  background-color: var(--bg-primary, #000000);
  color: var(--text-primary, #33ff33);
  border: 1px solid var(--accent-primary, #33ff33);
  padding: 6px 8px;
  font-family: var(--font-main), 'Courier New', monospace;
}

.file-dialog-select {
  cursor: pointer;
}

.file-dialog-actions {
  display: flex;
  justify-content: flex-end;
  padding: 12px 16px;
  border-top: 1px solid var(--accent-primary, #33ff33);
}

.file-dialog-button {
  background-color: var(--bg-primary, #000000);
  color: var(--accent-primary, #33ff33);
  border: 1px solid var(--accent-primary, #33ff33);
  padding: 6px 12px;
  margin-left: 8px;
  cursor: pointer;
  text-transform: uppercase;
}

.file-dialog-button:hover {
  background-color: var(--accent-primary, #33ff33);
  color: var(--bg-primary, #000000);
}

.file-dialog-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* File list styles for open dialog */
.file-dialog-section {
  margin-top: 16px;
}

.file-dialog-section h4 {
  color: var(--accent-secondary, #00ffff);
  margin: 0 0 8px 0;
  text-transform: uppercase;
  border-bottom: 1px solid var(--accent-secondary, #00ffff);
  padding-bottom: 4px;
}

.file-dialog-list {
  list-style-type: none;
  padding: 0;
  margin: 0;
  max-height: 200px;
  overflow-y: auto;
  border: 1px solid var(--accent-primary, #33ff33);
  background-color: var(--bg-primary, #000000);
}

.file-dialog-item {
  padding: 6px 8px;
  cursor: pointer;
  border-bottom: 1px solid rgba(51, 255, 51, 0.2);
}

.file-dialog-item:last-child {
  border-bottom: none;
}

.file-dialog-item:hover {
  background-color: rgba(51, 255, 51, 0.1);
}

.file-dialog-item.selected {
  background-color: rgba(0, 255, 255, 0.2);
}

.file-dialog-item.directory {
  color: var(--accent-secondary, #00ffff);
}

.file-dialog-navigation {
  margin-bottom: 12px;
  display: flex;
}

/* Open file dialog specific styles */
.open-file-dialog .file-dialog-list {
  max-height: 150px;
}
